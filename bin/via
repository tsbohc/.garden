#!/bin/bash

run() {
  echo -e "\$ $*\n"
  echo "$(date '+%y-%m-%d_%H:%M:%S')	$*" >> ~/.cache/xbps-hist
  "$@"
}

# operations

upd() {
  run sudo xbps-install -Su
}

ins() {
  #if ! [[ -f /tmp/via_uptodate ]] || [[ "$(find /tmp/via_uptodate -mmin +1)" ]]; then
  #  rm /tmp/via_uptodate
  #  touch /tmp/via_uptodate
  #  opt="-Su"
  #fi
  run sudo xbps-install "$@"
}

rem() {
  run sudo xbps-remove -R "$@"
}

cln() {
  run sudo xbps-remove -Oo
}

operation=$1 ; shift
case $operation in
  upd) upd ;;
  ins) ins "$@" ;;
  rem) rem "$@" ;;
  cln) cln ;;
  *) echo "xbps wrapper

USAGE
  \$ !fixme! <operation> [arguments]
" ;;
esac
